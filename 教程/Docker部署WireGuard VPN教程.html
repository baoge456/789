<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docker部署WireGuard VPN教程</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #1a1a2e;
            color: #e6e6e6;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: linear-gradient(135deg, #162747 0%, #1a1a2e 100%);
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #4cc9f0;
            text-shadow: 0 2px 5px rgba(76, 201, 240, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #a0a0a0;
            margin-bottom: 20px;
        }
        
        .logo {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #4cc9f0;
        }
        
        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .card {
            background: #162747;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        .card h2 {
            color: #4cc9f0;
            margin-bottom: 15px;
            font-size: 1.5rem;
            border-bottom: 2px solid #4cc9f0;
            padding-bottom: 10px;
        }
        
        .card-content {
            min-height: 200px;
        }
        
        .code-block {
            background: #0d1b2a;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            color: #8ac926;
            border-left: 4px solid #4cc9f0;
        }
        
        .code-block code {
            display: block;
            white-space: pre-wrap;
        }
        
        .step {
            counter-increment: step-counter;
            margin-bottom: 20px;
            padding-left: 50px;
            position: relative;
        }
        
        .step:before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background: #4cc9f0;
            color: #162747;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .note {
            background: #2c3e50;
            border-left: 4px solid #f72585;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .warning {
            background: #4a235a;
            border-left: 4px solid #ff9e00;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #a0a0a0;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .cards {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">🐳</div>
            <h1>Docker部署WireGuard VPN教程</h1>
            <p class="subtitle">快速搭建安全、高效的VPN服务</p>
        </header>
        
        <div class="cards">
            <div class="card">
                <h2>什么是WireGuard?</h2>
                <div class="card-content">
                    <p>WireGuard是一种现代VPN协议，具有以下优点：</p>
                    <ul style="padding-left: 20px; margin-top: 10px;">
                        <li>极高的性能</li>
                        <li>简洁的代码库（约4000行代码）</li>
                        <li>强大的加密技术</li>
                        <li>易于配置和使用</li>
                        <li>跨平台支持</li>
                    </ul>
                    <p style="margin-top: 15px;">使用Docker部署可以进一步简化安装和管理过程。</p>
                </div>
            </div>
            
            <div class="card">
                <h2>准备工作</h2>
                <div class="card-content">
                    <p>在开始之前，请确保：</p>
                    <ul style="padding-left: 20px; margin-top: 10px;">
                        <li>已安装Docker和Docker Compose</li>
                        <li>拥有一个Linux服务器（Ubuntu/CentOS等）</li>
                        <li>服务器防火墙开放UDP端口51820</li>
                        <li>具有root或sudo权限</li>
                    </ul>
                    <p style="margin-top: 15px;">建议使用至少1GB内存的服务器以获得最佳性能。</p>
                </div>
            </div>
            
            <div class="card">
                <h2>部署步骤概览</h2>
                <div class="card-content">
                    <ol style="padding-left: 20px;">
                        <li>安装Docker和Docker Compose</li>
                        <li>创建docker-compose.yml文件</li>
                        <li>配置WireGuard环境变量</li>
                        <li>启动WireGuard容器</li>
                        <li>获取客户端配置文件</li>
                        <li>连接测试</li>
                    </ol>
                    <p style="margin-top: 15px;">整个过程大约需要10-15分钟完成。</p>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>详细部署步骤</h2>
            <div class="card-content">
                <div class="step">
                    <h3>安装Docker和Docker Compose</h3>
                    <p>如果尚未安装，请运行以下命令：</p>
                    <div class="code-block">
                        <code># 安装Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# 安装Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# 验证安装
docker --version
docker-compose --version</code>
                    </div>
                </div>
                
                <div class="step">
                    <h3>创建部署目录和配置文件</h3>
                    <p>创建一个新目录并创建docker-compose.yml文件：</p>
                    <div class="code-block">
                        <code># 创建目录
mkdir wireguard-docker && cd wireguard-docker

# 创建docker-compose.yml文件
nano docker-compose.yml</code>
                    </div>
                </div>
                
                <div class="step">
                    <h3>编辑docker-compose.yml文件</h3>
                    <p>将以下内容复制到docker-compose.yml文件中：</p>
                    <div class="code-block">
                        <code>version: '3.8'

services:
  wireguard:
    image: lscr.io/linuxserver/wireguard:latest
    container_name: wireguard
    cap_add:
      - NET_ADMIN
      - SYS_MODULE
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Shanghai
      - SERVERURL=your-server-domain.com  # 改为你的服务器IP或域名
      - SERVERPORT=51820
      - PEERS=3  # 要创建的客户端配置数量
      - PEERDNS=1.1.1.1
      - INTERNAL_SUBNET=10.13.13.0
    volumes:
      - ./config:/config
      - /lib/modules:/lib/modules
    ports:
      - 51820:51820/udp
    restart: unless-stopped</code>
                    </div>
                    <div class="note">
                        <p><strong>注意：</strong> 请将<code>your-server-domain.com</code>替换为你的服务器实际IP地址或域名。</p>
                    </div>
                </div>
                
                <div class="step">
                    <h3>启动WireGuard容器</h3>
                    <p>运行以下命令启动WireGuard服务：</p>
                    <div class="code-block">
                        <code># 启动容器（在后台运行）
docker-compose up -d

# 查看容器状态
docker-compose ps

# 查看日志
docker-compose logs</code>
                    </div>
                </div>
                
                <div class="step">
                    <h3>获取客户端配置文件</h3>
                    <p>配置文件将生成在config目录中：</p>
                    <div class="code-block">
                        <code># 查看生成的客户端配置
ls config/peer*

# 查看peer1的配置
cat config/peer1/peer1.conf

# 或使用QR码（如果支持）
docker exec -it wireguard qrencode -t ansiutf8 -r /config/peer1/peer1.conf</code>
                    </div>
                    <div class="note">
                        <p><strong>提示：</strong> 每个peer文件夹包含一个.conf文件和一个QR码图片，可用于移动设备快速连接。</p>
                    </div>
                </div>
                
                <div class="step">
                    <h3>客户端连接</h3>
                    <p>根据你的设备类型，选择相应方式连接：</p>
                    <ul style="padding-left: 20px; margin-top: 10px;">
                        <li><strong>Windows/Mac：</strong> 下载官方WireGuard客户端，导入.conf文件</li>
                        <li><strong>Android/iOS：</strong> 安装WireGuard应用，扫描QR码或导入配置文件</li>
                        <li><strong>Linux：</strong> 安装WireGuard，使用命令<code>wg-quick up /path/to/config.conf</code></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>管理命令和故障排除</h2>
            <div class="card-content">
                <h3>常用管理命令</h3>
                <div class="code-block">
                    <code># 查看运行状态
docker-compose ps

# 查看日志
docker-compose logs

# 停止服务
docker-compose down

# 重启服务
docker-compose restart

# 添加更多客户端
# 编辑docker-compose.yml增加PEERS数量，然后重启
docker-compose down
docker-compose up -d</code>
                </div>
                
                <h3>常见问题解决</h3>
                <div class="warning">
                    <p><strong>连接问题：</strong> 确保服务器防火墙已开放UDP端口51820</p>
                </div>
                <div class="warning">
                    <p><strong>容器启动失败：</strong> 检查日志中的错误信息，通常是权限或模块问题</p>
                </div>
                <div class="warning">
                    <p><strong>无法访问互联网：</strong> 检查服务器的IP转发设置，确保已启用</p>
                </div>
                
                <h3>启用IP转发</h3>
                <p>如果VPN客户端无法访问互联网，可能需要启用IP转发：</p>
                <div class="code-block">
                    <code># 编辑sysctl.conf文件
echo "net.ipv4.ip_forward = 1" | sudo tee -a /etc/sysctl.conf

# 应用更改
sudo sysctl -p</code>
                </div>
            </div>
        </div>
        
        <footer>
            <p>© 2023 Docker WireGuard VPN教程 | 本教程仅供参考，请遵守当地法律法规使用VPN服务</p>
        </footer>
    </div>
</body>
</html>